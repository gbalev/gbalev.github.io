<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Gallery from GitHub Repository</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #f6f8fa;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
        }

        h1 {
            color: #2ea44f;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #586069;
            font-size: 1.1rem;
        }

        .config-form {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #24292e;
        }

        input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            font-size: 14px;
        }

        input:focus {
            outline: none;
            border-color: #0366d6;
            box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.3);
        }

        .btn {
            background-color: #2ea44f;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        .btn:hover {
            background-color: #2c974b;
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .image-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .image-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }

        .image-info {
            padding: 15px;
        }

        .image-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: #24292e;
            word-break: break-all;
        }

        .image-size {
            color: #586069;
            font-size: 0.9rem;
        }

        .error {
            background: #fde8e8;
            color: #c53030;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            display: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 5px;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }

        .no-images {
            text-align: center;
            padding: 40px;
            color: #586069;
            display: none;
        }

        .repository-info {
            background: white;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
        }

        @media (max-width: 768px) {
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .gallery {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ“· GitHub Image Gallery</h1>
            <p class="subtitle">Display images from any public GitHub repository</p>
        </header>

        <div class="config-form">
            <div class="form-group">
                <label for="repoOwner">Repository Owner</label>
                <input type="text" id="repoOwner" placeholder="e.g., octocat" value="">
            </div>
            <div class="form-group">
                <label for="repoName">Repository Name</label>
                <input type="text" id="repoName" placeholder="e.g., images" value="">
            </div>
            <div class="form-group">
                <label for="folderPath">Folder Path (optional)</label>
                <input type="text" id="folderPath" placeholder="e.g., photos/ or leave empty for root">
            </div>
            <button class="btn" id="loadImages">Load Images</button>
        </div>

        <div class="repository-info" id="repoInfo">
            <strong>Repository:</strong> <span id="currentRepo"></span>
        </div>

        <div class="loading" id="loading">
            Loading images...
        </div>

        <div class="error" id="errorMessage"></div>

        <div class="no-images" id="noImages">
            No images found in this repository or folder.
        </div>

        <div class="gallery" id="gallery"></div>

        <div class="modal" id="imageModal">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <img id="modalImage" src="" alt="">
        </div>
    </div>

    <script>
        // Configuration - Change these to your default repository
        const DEFAULT_OWNER = 'gbalev';  // Replace with your GitHub username
        const DEFAULT_REPO = 'Scanned_Old_Pictures';  // Replace with your image repository name

        // Set default values
        document.getElementById('repoOwner').value = DEFAULT_OWNER;
        document.getElementById('repoName').value = DEFAULT_REPO;

        // Image extensions to look for
        const IMAGE_EXTENSIONS = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg'];

        // Function to check if a file is an image
        function isImageFile(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            return IMAGE_EXTENSIONS.includes(ext);
        }

        // Function to get raw GitHub URL for an image
        function getRawGitHubUrl(owner, repo, path) {
            return `https://raw.githubusercontent.com/${owner}/${repo}/main/${path}`;
        }

        // Function to get repository contents via GitHub API
        async function getRepoContents(owner, repo, path = '') {
            const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
            
            try {
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('Repository not found or folder does not exist');
                    } else if (response.status === 403) {
                        throw new Error('API rate limit exceeded. Try again later.');
                    } else {
                        throw new Error(`Error: ${response.status} - ${response.statusText}`);
                    }
                }
                
                return await response.json();
            } catch (error) {
                throw error;
            }
        }

        // Function to recursively find all images in repository
        async function findAllImages(owner, repo, path = '') {
            const contents = await getRepoContents(owner, repo, path);
            let images = [];

            for (const item of contents) {
                if (item.type === 'file' && isImageFile(item.name)) {
                    images.push({
                        name: item.name,
                        path: item.path,
                        url: item.download_url || getRawGitHubUrl(owner, repo, item.path),
                        size: item.size ? formatFileSize(item.size) : 'Unknown size'
                    });
                } else if (item.type === 'dir') {
                    // Recursively search subdirectories
                    const subImages = await findAllImages(owner, repo, item.path);
                    images = images.concat(subImages);
                }
            }

            return images;
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Display images in gallery
        function displayImages(images) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';

            if (images.length === 0) {
                document.getElementById('noImages').style.display = 'block';
                return;
            }

            images.forEach(image => {
                const imageCard = document.createElement('div');
                imageCard.className = 'image-card';
                imageCard.innerHTML = `
                    <img src="${image.url}" alt="${image.name}" loading="lazy" onclick="openModal('${image.url}')">
                    <div class="image-info">
                        <div class="image-name">${image.name}</div>
                        <div class="image-size">${image.size}</div>
                    </div>
                `;
                gallery.appendChild(imageCard);
            });
        }

        // Modal functions
        function openModal(imageUrl) {
            document.getElementById('modalImage').src = imageUrl;
            document.getElementById('imageModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside the image
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Main function to load images
        async function loadImages() {
            const owner = document.getElementById('repoOwner').value.trim();
            const repo = document.getElementById('repoName').value.trim();
            const folderPath = document.getElementById('folderPath').value.trim();

            // Hide previous states
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('noImages').style.display = 'none';
            document.getElementById('gallery').innerHTML = '';
            
            // Show loading
            document.getElementById('loading').style.display = 'block';

            try {
                if (!owner || !repo) {
                    throw new Error('Please enter both repository owner and name');
                }

                // Update repository info
                document.getElementById('currentRepo').textContent = `${owner}/${repo}`;
                document.getElementById('repoInfo').style.display = 'block';

                // Get images
                const images = await findAllImages(owner, repo, folderPath);
                
                // Display images
                displayImages(images);
                
            } catch (error) {
                console.error('Error loading images:', error);
                document.getElementById('errorMessage').textContent = error.message;
                document.getElementById('errorMessage').style.display = 'block';
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Event listeners
        document.getElementById('loadImages').addEventListener('click', loadImages);

        // Allow Enter key to trigger loading
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loadImages();
                }
            });
        });

        // Load default images on page load
        window.addEventListener('DOMContentLoaded', () => {
            // Uncomment the line below to auto-load images on page load
            // loadImages();
        });
    </script>
</body>
</html>